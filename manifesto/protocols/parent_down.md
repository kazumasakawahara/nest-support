# 親の機能不全トリガー (Parent Down Trigger)

**マニフェスト価値:** 強靭性 (Resilience)
**マニフェストルール:** ルール2
**優先度:** 高 - 緊急時プロトコルに次ぐ

---

## トリガー条件

以下の状況を示す入力があった場合、このプロトコルを発動する。

**キーワード:**
- 「母が入院した」「父が倒れた」「親が認知症になった」
- 「一人になった」「家に誰もいない」
- 「介護が必要になった」「施設に入った」
- 「亡くなった」「死亡した」

---

## 実行手順

### フェーズ1：緊急情報の確認（emergency.mdが先行している場合はスキップ）

→ `neo4j-support-db` スキルのテンプレート2（クライアントプロフィール）を `neo4j` MCP の `read_neo4j_cypher` で実行。

禁忌事項と緊急連絡先を最初に確認し、安全を確保する。

### フェーズ2：親の担当タスク（CareRole）の特定

親がどのような役割を担っていたかをグラフデータベースから取得する。

以下のCypherを `neo4j` MCP の `read_neo4j_cypher` で実行:
```cypher
MATCH (r:Relative {name: '親の名前'})-[:PERFORMS]->(cr:CareRole)
RETURN cr.name AS タスク名, cr.frequency AS 頻度, cr.notes AS 備考
ORDER BY cr.priority DESC
```

**典型的なCareRole:**
- 金銭管理（お小遣い管理、家賃支払い）
- 食事準備（調理、買い出し）
- 服薬管理（薬の準備、声かけ）
- 送迎（作業所、通院）
- 身辺介助（入浴、着替え）
- 精神的安定（パニック時の対応、日常の見守り）

### フェーズ3：代替手段の検索

各CareRoleに紐づく代替サービス・代替人物を検索する。

以下のCypherを `neo4j` MCP の `read_neo4j_cypher` で実行:
```cypher
MATCH (cr:CareRole {name: 'タスク名'})-[:CAN_BE_PERFORMED_BY]->(alt)
RETURN labels(alt) AS 種類, alt.name AS 名前, alt.phone AS 連絡先, alt.notes AS 備考
```

代替手段が見つからない場合は、以下で候補を探す：

→ `provider-search` スキルのテンプレート1（事業所検索）を `neo4j` MCP の `read_neo4j_cypher` で実行。

**サービス種類のマッピング:**
| CareRole | 対応する福祉サービス |
|----------|---------------------|
| 食事準備 | 居宅介護（家事援助）、配食サービス |
| 金銭管理 | 日常生活自立支援事業、成年後見制度 |
| 服薬管理 | 居宅介護、訪問看護 |
| 送迎 | 移動支援、行動援護 |
| 身辺介助 | 居宅介護（身体介護） |
| 精神的安定 | 地域定着支援、短期入所 |
| 見守り全般 | グループホーム、自立生活援助 |

### フェーズ4：レジリエンス・レポートの作成

全ての情報を統合して、以下の形式でレポートを提示する。

```
## 🔄 レジリエンス・レポート
**対象:** [本人名]
**発生事象:** [親の名前]の[状況]
**日付:** [日付]

### 影響を受けるタスク一覧

| # | タスク | 頻度 | 代替手段 | ステータス |
|---|--------|------|----------|-----------|
| 1 | 食事準備 | 毎日 | ○○居宅介護 | ✅ 手配済み |
| 2 | 金銭管理 | 月2回 | 社会福祉協議会 | ⚠️ 調整中 |
| 3 | 送迎 | 週5 | 未登録 | 🚨 緊急対応必要 |

### 即座のアクション
- [未登録のタスクに対する具体的な手配提案]

### 中長期の対応
- [支援体制の見直し提案]
```

### フェーズ5：フォローアップ

- 必要に応じてキーパーソンへの連絡を促す
- 代替手段が全て確保されるまで、定期的な確認を提案する
- 状況の変化（親の退院等）があれば、CareRoleの再評価を行う

→ 詳細なレポート生成は `workflows/resilience_report.md` を参照

---

## CareRoleが未登録の場合

Parent Down Triggerが発動したが、CareRoleがデータベースに登録されていない場合：

1. **警告を発する:**
   「⚠️ [親の名前]さんのCareRole（担当タスク）が未登録です。緊急の支援調整が必要です。」

2. **ヒアリングを開始する:**
   「[親の名前]さんが日常的に行っていたことを教えてください。」
   - 食事は誰が作っていましたか？
   - お金の管理は？
   - 通院の送り迎えは？
   - 薬の管理は？

3. **取得した情報を登録:**
   ヒアリング結果をCareRoleとしてデータベースに登録する。

---

## 実例：reasoning.logから学んだパターン

### パターン：母の入院（山田健太のケース）
```
入力: 「母（山田花子）が急病で入院してしまいました。今、家には本人（山田健太）だけが残されており、食事の準備ができていません。」

実行順序:
1. search_emergency_info(client_name="山田健太") → 禁忌事項・推奨ケア確認
2. CareRole検索 → 母(山田花子)が担う「食事準備」「服薬管理」等を特定
3. 代替手段検索 → 登録済みの代替サービス・人物を取得
4. search_service_providers(service_type="居宅介護") → 未登録タスクの代替候補
5. レジリエンス・レポート提示 → 一覧表形式で状況を可視化
```
